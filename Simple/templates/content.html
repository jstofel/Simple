{% extends "layout.html" %}

{% block body %}


<!-- Show the Page the User Has Requested -->
<!-- Note: there are no longer any records in the pageresult cursor, as we have moved through them all and it has closed -->

<!--Put in a Markdown Editor to accept content-->
<!-- It has a Show/Hide Button, a Div with instructions, an Editor div that lets you write, and a Target div 
     that shows what you've written, all closed out by a div to clear the floats.
     The functionality of this Markdown editor comes from the ShowDown library
     at http://showdownjs.github.io/demo/ by John Fraser . Thanks! -->

<form id="editContentForm"
      action="/{{pageInfo['page_target'][0]}}?page_id={{pageInfo['page_id'][0]}}"
      method="POST" >

<div id="BUTTONS" class=""  style='float:left; width:48%; height:3rem '>
<input type='button' id='showEditContent' value='Open Editor' style='width:8rem' >
<input type='submit' id='saveit' value='Save' style='display:none' >
<input type = "hidden" name="page_id" value="{{pageInfo['page_id'][0]}}" >
<!-- note: currently only handling one content per page-->
<input type = "hidden" name="content_id" value="{{pageContent['content_id'][0]}}" > 
</div>

<div id="INSTRUCTIONS"  class="" style='float:left; width:45% ; height:3rem; display:none; '>
 Edit the content in the textarea below using markdown styling, and see how it renders on the left.
</div>

<div id="targetDiv" class=""  style='float:left; width:80%;'>{{pageContent['content_ht'][0]}}</div>

<div id="editorDiv"  class="" style='float:right;width:52%; display:none; '>
<textarea id="sourceTA" name="content_md" rows="40" cols="40"   onInput="runConverter()">{{pageContent['content_md'][0]}}</textarea>
<textarea id="targetTA" name="content_ht" rows="40" cols="40" style='display:none'>{{pageContent['content_ht'][0]}}</textarea>
</div>

</form>

<div style='float:none'> </div>



<!-- Add JQ functionality to show/hide buttons for the Single Page controls-->
<script>
jQuery(document).ready(function(){

jQuery('#showEditContent').on('click', function(event) {
             $('#editorDiv').toggle();
             $('#INSTRUCTIONS').toggle();
             if ( $(this).val() == 'Close Editor' ) {
                 $(this).val('Open Editor');
                 $('#targetDiv').width('80%');
                 $('#saveit').hide()
             } else {
                 $(this).val('Close Editor');
                 $('#targetDiv').width('48%');
                 $('#saveit').show()
            }
        });
    });


   //Run the load conditions
   //The runConverter function takes the input conent, translates it, and writes it to the target div
   window.onload = function(){
     runConverter();
   }


</script>


{% endblock %}
